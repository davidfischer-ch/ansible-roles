---

- name: reload uwsgi
  command: >
    service uwsgi reload || service uwsgi restart
  become: yes

- name: reload uwsgi apps
  command: >
    supervisorctl uwsgi-{{ item.value.name }} reload
  become: yes
  loop: "{{ lookup('dict', uwsgi_apps) }}"
  loop_control:
    label: '{{ item.value.name }}'

- name: restart uwsgi
  service: >
    name=uwsgi state=restarted
  become: yes

- name: restart uwsgi apps
  supervisorctl: >
    name=uwsgi-{{ item.value.name }} state=restarted
  become: yes
  loop: "{{ lookup('dict', uwsgi_apps) }}"
  loop_control:
    label: '{{ item.value.name }}'
