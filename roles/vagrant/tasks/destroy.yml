---

- include: configure.yml

- name: Destroy machines
  vagrant_machine: >
    chdir={{ vagrant_machines_directory }} name={{ item.key }} state=absent
    timeout={{ item.value.timeout|int if item.value.timeout is defined else omit }}
  loop_control:
    label: '{{ item.key }}'
  with_dict: '{{ vagrant_machines }}'

- name: Cleanup machines SSH authentication footprints
  known_hosts: >
    name={{ item.value.host_public }} state=absent
  loop_control:
    label: '{{ item.key }}'
  with_dict: '{{ vagrant_machines }}'
