---

- assert:
    that:
      - vagrant_power_mode in vagrant_power_modes

- include: configure.yml

- name: Set machines power mode
  vagrant_machine: >
    chdir=/tmp name={{ item.key }} provider={{ item.value.provider }} state={{ vagrant_power_mode }}
    timeout={{ item.value.timeout|int if item.value.timeout is defined else omit }}
  loop_control:
    label: '{{ item.key }}'
  with_dict: '{{ vagrant_machines }}'
