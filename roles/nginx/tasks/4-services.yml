---

- block:
    - name: Start Nginx service
      supervisorctl: >
        name=nginx state=started
      ignore_errors: yes
      register: nginx_start_result

    - name: Restart Nginx service
      supervisorctl: >
        name=nginx state=restarted
      when: nginx_start_result|failed
  become: yes
  when: "nginx_daemon_mode == 'supervisor'"

- name: Start Nginx service
  service: >
    name=nginx state=started enabled=yes
  become: yes
  when: "nginx_daemon_mode == 'systemv'"
