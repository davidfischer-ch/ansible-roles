---

- block:
    - name: Install Ansible packages
      package: >
        name={{ item }} state=present
      with_items: '{{ the_ansible_packages }}'

    - name: Install Ansible Python package
      pip: >
        name="ansible{{ the_ansible_version|regex_replace('^latest$', '') }}" executable=pip2 state=present

    # FIXME may iterate over the_ansible_modules and use map('extract', ...)

    - name: Install Ansible modules packages
      package: >
        name="{{ item.value|join(' ') }}" state=present
      when: item.key in the_ansible_modules and item.value
      with_dict: '{{ the_ansible_modules_packages }}'

    - name: Install Ansible modules Python package
      pip: >
        name="{{ item.value|join(' ') }}" executable=pip2 state=present
      when: item.key in the_ansible_modules and item.value
      with_dict: '{{ the_ansible_modules_python_packages }}'
  become: yes
  tags: [ansible, packages]
