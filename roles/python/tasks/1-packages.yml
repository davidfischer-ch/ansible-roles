---

- name: Install building and development tools
  apt: >
    name={{ item }} state=latest
  sudo: yes
  with_items:
    - bpython
    - bpython3
    - build-essential
    - checkinstall
    - python-dev
    - python3-dev

- name: Download pip bootstrap script
  get_url: >
    url=https://bootstrap.pypa.io/get-pip.py dest=/tmp/get-pip.py sha256sum={{ python_get_pip_checksum }}
  sudo: yes

- name: Install pip
  command: >
    python{{ item }} /tmp/get-pip.py
  changed_when: "'already up-to-date' not in python_pip_install_result.stdout"
  register: python_pip_install_result
  sudo: yes
  with_items: python_versions

- name: Set pip default version
  file: >
    src={{ python_pip_path }}{{ python_pip_default_version }} dest={{ python_pip_path }} force=yes state=link
  sudo: yes

- name: Install setuptools
  pip: >
    name=setuptools executable=pip{{ item }}
  sudo: yes
  with_items: python_pip_versions

- name: Install virtualenv
  pip: >
    name=virtualenv executable=pip{{ item }} state=latest
  sudo: yes
  with_items: python_pip_versions
