---

- name: Install extra PPA repositories
  apt_repository: >
    repo={{ item }} state=present
  register: extra_ppa_result
  become: yes
  with_items: extra_ppa_repos

- name: Upgrade the Debian packages
  shell: >
    sudo dpkg --configure -a &&
    apt-get -y update &&
    apt-get -y upgrade &&
    apt-get -y dist-upgrade &&
    apt-get -y autoremove &&
    apt-get -y autoclean
  async: 600
  poll: 5
  become: yes
  when: upgrade_packages|bool

- name: Install extra Debian packages
  apt: >
    name={{ item }} state=latest
  become: yes
  with_items: extra_packages

- name: Set swappiness
  sysctl: >
    name=vm.swappiness value={{ vm_swappiness|int }} sysctl_set=yes state=present
  become: yes
